(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var o=0;o<t.length;o++){var s=t[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,r(s.key),s)}}function r(t){var r=function(t,r){if("object"!=e(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var s=o.call(t,r||"default");if("object"!=e(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==e(r)?r:r+""}var o=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init(),this.handleEvents()},r=[{key:"init",value:function(){this.customerSearchInput=$("#customer_search"),this.customerSearchResults=$("#customer_search_results"),this.selectedCustomerInfo=$("#selected_customer_info"),this.customerIdInput=$("#customer_id"),this.createNewCustomerBtn=$("#btn_create_new_customer"),this.searchUrl=route("car-rentals.bookings.search-customers"),this.getCustomerUrl=route("car-rentals.bookings.get-customer"),this.customerFields=["name","email","phone","customer_age","country","state","city","address","zip"]}},{key:"handleEvents",value:function(){var e=this;this.customerSearchInput.on("keyup",(function(){var t=$(this).val();t.length<1?e.customerSearchResults.hide():e.searchCustomers(t)})),$(document).on("click",(function(t){$(t.target).closest("#customer_search_results, #customer_search").length||e.customerSearchResults.hide()})),this.createNewCustomerBtn.on("click",(function(){$("#create-customer-modal").modal("show")})),$("#create-customer-button").on("click",(function(){e.createCustomer()})),$("#create-customer-modal").on("hidden.bs.modal",(function(){$("#create-customer-form")[0].reset(),$("#modal-error-msg").addClass("d-none").html("")}))}},{key:"createCustomer",value:function(){var e=this,t={name:$("#modal_name").val(),email:$("#modal_email").val(),phone:$("#modal_phone").val(),customer_age:$("#modal_customer_age").val(),address:$("#modal_address").val(),city:$("#modal_city").val(),state:$("#modal_state").val(),country:$("#modal_country").val(),zip:$("#modal_zip").val()};$("#create-customer-button").prop("disabled",!0).html('<i class="fa fa-spinner fa-spin"></i> Creating...'),$("#modal-error-msg").addClass("d-none").html(""),$.ajax({url:route("car-rentals.bookings.create-customer"),type:"POST",data:t,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(t){if(t.error)$("#modal-error-msg").removeClass("d-none").html(t.message);else{$("#create-customer-modal").modal("hide");var r=t.data.customer;e.selectedCustomerInfo.html(t.data.html).show(),e.fillCustomerFields(r),e.customerIdInput.val(r.id),e.customerSearchInput.val("".concat(r.name)),$("#booking_details_container").removeClass("d-none"),Botble.showSuccess(t.data.message)}},error:function(e){$("#modal-error-msg").removeClass("d-none").html("Error creating customer: "+e.responseJSON.message)},complete:function(){$("#create-customer-button").prop("disabled",!1).html("Create Customer")}})}},{key:"searchCustomers",value:function(e){var t=this;this.customerSearchResults.html('<div class="dropdown-item">Loading...</div>').show(),$.ajax({url:this.searchUrl,type:"GET",data:{q:e},success:function(e){t.renderSearchResults(e.data)},error:function(e){console.error("Error searching customers:",e),t.customerSearchResults.html('<div class="dropdown-item">Error loading results</div>')}})}},{key:"renderSearchResults",value:function(e){var t=this;this.customerSearchResults.html(e.html).show(),e.html&&""!==e.html.trim()||this.customerSearchResults.html('<div class="dropdown-item">No results found</div>'),$(".customer-item").on("click",(function(){var e=$(this).data("id");t.selectCustomer(e),t.customerSearchResults.hide()}))}},{key:"selectCustomer",value:function(e){var t=this;$.ajax({url:this.getCustomerUrl,type:"GET",data:{id:e},success:function(e){if(e.error)Botble.showError(e.message);else{var r=e.data.customer;t.selectedCustomerInfo.html(e.data.html).show(),t.fillCustomerFields(r),t.customerIdInput.val(r.id),t.customerSearchInput.val("".concat(r.name)),$("#booking_details_container").removeClass("d-none")}},error:function(e){console.error("Error getting customer:",e)}})}},{key:"fillCustomerFields",value:function(e){this.customerFields.forEach((function(t){e[t]&&$("#".concat(t)).val(e[t])}))}},{key:"clearCustomerSelection",value:function(){this.customerFields.forEach((function(e){$("#".concat(e)).val("")}))}}],r&&t(e.prototype,r),o&&t(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,o}();$(document).ready((function(){new o}))})();